#! /usr/bin/python
from __future__ import print_function

from scapy.all import *

print("hello")

#print(sniff.__doc__)
## Create a Packet Counter
counter = 0

## Define our Custom Action function
def custom_action(packet):
    global counter
    counter += 1
    return 'Packet #{}: {} ==> {}'.format(counter, packet[0][1].src, packet[0][1].dst)

## Setup sniff, filtering for IP traffic
#sniff(filter="mac", prn=custom_action)
print("Sniffing")
#sniff(lfilter=lambda d: d.src == "aa:aa:aa:aa:bb:bb:bb:bb", prn=custom_action)
#sniff(filter='ether dst aa:aa:aa:aa:bb:bb',prn=custom_action)

packets = sniff(iface='wlp8s0',filter='ether src aa:aa:aa:aa:bb:bb', count=2)
print("Packets captured with MAC OF aa:aa:aa:aa:bb:bb")
print(packets.summary())

for x in range(0,1):
    print(packets[x].show())
#print(packets[0].show())

print("The beacon malware is at :")
print(packets[0][Ether].src)

chief = (packets[0][ARP].psrc)
print("CHIEF IPADDRESS = ", chief)